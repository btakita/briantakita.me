---
import type { SearchItem } from '@btakita/domain--all--blog'
import { Main_search } from '@btakita/ui--server--blog'
import { getCollection } from 'astro:content'
import Footer from '../../components/Footer.astro'
import Header from '../../components/Header.astro'
import { SITE } from '../../config'
import Layout from '../../layouts/Layout.astro'
import { server__ctx__new } from '../../lib'
const ctx = server__ctx__new(Astro)
const posts = await getCollection('posts',
	({ data })=>
		!data.draft)
// List of items to search in
const search_item_a = posts.map(post=>({
	title: post.data.title,
	description: post.data.description,
	post__data: post.data,
} as SearchItem))
---

<Layout title={`Search | ${SITE.title}`}>
	<Header ctx={ctx} active="search"/>
	<Main_search
		ctx={ctx}
		title="Search"
		desc="Search any article ..."
		search_item_a={search_item_a}
	/>
	<Footer ctx={ctx}/>
</Layout>

<script>
	import { Main_search__onbind } from '@btakita/ui--all--blog'
	import { dom__onbind__register } from '@ctx-core/dom'
	import { browser__ctx__ensure } from '../../lib'
	const ctx = browser__ctx__ensure()
	dom__onbind__register(ctx, Main_search__onbind)
</script>